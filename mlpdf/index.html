<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Dimitry Grebenyuk">
    
    <link rel="shortcut icon" href="https://grebenyyk.github.io/favicon.ico">
    
    <link rel="stylesheet" href="/css/style.min.css">

    <link rel="canonical" href="https://grebenyyk.github.io/mlpdf/" />
    <title>Облучаем и обучаем</title>
</head>
<body><header id="banner">
    <h2><a href="https://grebenyyk.github.io/">Dimitry Grebenyuk</a></h2>
    <nav>
        <ul>
            <li>
                <a href="mailto:dimitrygrebenyuk@gmail.com" title="">E-mail</a>
            </li><li>
                <a href="https://scholar.google.com/citations?user=pNWZLJoAAAAJ&amp;hl=en" title="">publications</a>
            </li><li>
                <a href="https://github.com/grebenyyk" title="">code</a>
            </li><li>
                <a href="https://instagram.com/grebenyyk" title="">Instagram</a>
            </li><li>
                <a href="https://twitter.com/grebenyyk" title="">Twitter</a>
            </li><li>
                <a href="/cv/cv" title="">cv</a>
            </li>
        </ul>
    </nav>
</header>
<main id="content">
<article>
    <header id="post-header">
        <h1>Облучаем и обучаем</h1>
        <div>
                <time>February 11, 2023</time>
            </div>
    </header><p>Последние два месяца твиттер только и делает, что обсуждает искусственный интеллект, нейросети и большие языковые модели. Ажиотаж масштабнейший: Майкрософт за неделю <a href="https://www.theverge.com/2023/2/7/23587454/microsoft-bing-edge-chatgpt-ai">прикрутил ChatGPT</a> к поисковику Bing; <a href="https://edition.cnn.com/2023/02/08/tech/google-ai-bard-demo-error/index.html">акции Гугла упали</a> из-за того, что чатбот Bard ошибся на презентации; ChatGPT пишет за студентов дипломы, за кодеров — код; кто-то говорит что это — наше будущее и надо ловить момент; кто-то переживает, что на работе их скоро заменит искусственный интеллект.</p>
<p>Химики и материаловеды тоже не стоят на месте и активно используют машинное обучение в своей практике. Хотя в некоторых уважаемых журналах <a href="https://www.nature.com/articles/s41586-022-05543-x">пишут</a>, что все-таки стоят. Вместе с молекулярными биологами и исследователями в области социальных наук.</p>
<p>Сегодня предлагаю посмотреть на статью <a href="https://doi.org/10.1038/s41524-022-00896-3">Extracting structural motifs from pair distribution function data of nanostructures using explainable machine learning</a>, в которой описывается применение машинного обучения для изучения структуры веществ.</p>
<p>Несколько вводных ремарок о принципе работы метода полного рентгеновского рассеяния, данные которого анализируют авторы исследования. Концепция вполне проста для интуитивного понимания: процесс напоминает съемку флюорограммы, но с менее наглядными картинками на выходе.</p>
<figure>
<img src="/PDF.jpg" style="width: 80%; max-width: 100%;" />
<figcaption align = "center"><i>Устройство лабораторного дифрактометра для сбора данных полного рентгеновского рассеяния. Источник излучения (А), держатель образца (Б), один из четырех детекторов (В). Сам образец заключен в тонкий стеклянный капилляр, закрепленный в держателе Б.</i></figcaption>
</figure>
<p>Вещество облучается жестким рентгеновским излучением, бо́льшая часть которого проходит вещество насквозь и не сохраняет информации о его структуре, а небольшая часть — рассеивается веществом в разные стороны. Установленный рядом детектор (или сборка из нескольких детекторов) регистрирует рассеянную часть излучения, а последующая обработка его интенсивности и угла рассеяния позволяет извлечь информацию о структуре вещества.</p>
<p>Основное ограничение метода заключается в том, что извлекаемой информации недостаточно для прямого однозначного определения координат атомов — это позволяет сделать, например, рентгеноструктурный анализ. В методе полного рассеяния на выходе получается одна кривая, называемая функцией парного распределения (pair distribution function, PDF). Она представляет собой гистограмму распределения межатомных расстояний в веществе.</p>
<figure>
<img src="/ceo2_pdf.jpg" style="width: 80%; max-width: 100%;" />
<figcaption align = "center"><i>Фрагмент кристаллической структуры диоксида церия и соотвествующая функция парного распределения. Синими окружностями и стрелками обозначены межатомные расстояния в структуре, проявляющиеся в виде пиков на PDF.</i></figcaption>
</figure>
<p>Проанализировав эти расстояния, можно сделать косвенные выводы о строении вещества и наличии в нем определенных структурных фрагментов. Подробный анализ данных PDF требует представления об исходной структурной модели вещества, желательно близкой к истинной.</p>
<p>Исходную задачу, которую решали авторы работы, можно сформулировать вот как. Чтобы определить строение исследуемого образца, из относительно крупного структурного фрагмента родственного вещества с известной структурой можно было бы последовательно повырезать фрагменты разного размера и строения и посмотреть, насколько хорошо теоретические PDF, рассчитанные для таких фрагментов, совпадают с экспериментальной PDF. Если совпадение точное, то можно считать, что соответствующая модель структуры верна. Проблема заключается в том, что если в исходной модели содержится 5 атомов, то пробных структур придется перебрать 31, если атомов 10 — около 1000, а если атомов 30 (что не редкость и далеко не предел) — то больше миллиарда. Это сильно увеличивает стоимость расчета, и, кроме этого, возникает еще одна проблема. Если для нескольких различных пробных структур сходство с экспериментом одинаково хорошее, то как выбрать единственно верную?</p>
<p>Исследователи предложили подход, основанный на алгоритме с элегантным русским названием «градиентный бустинг над решающими деревьями» (gradient boosting decision trees, GBDT). На первом этапе создается каталог пробных структур путем случайного вырезания фрагментов различного размера и строения из исходной крупной структуры. Затем для каждой сгенерированной структуры из каталога рассчитывается теоретическая PDF и сравнивается с экспериментальной. Количественным выражением сходства является фактор достоверности R, принимающий значения от 0 (полное сходство) до 1 (полное отутствие сходства). Затем пробные структуры и значения R-фактора используются в качестве входных данными для алгоритма GBDT.</p>
<p>Суть его работы заключается в проведении регрессионного анализа для ответа на вопрос относительно каждого атома исходной большой структуры, улучшается или ухудшается сходство теоретической и экспериментальной PDF при включении этого атома в модель структуры. Алгоритм выбирает произвольный атом, к которому последовательно добавляются новые атомы, и на основании результатов уточнения для пробных структур принимается решение, станет ли расчетная PDF лучше или хуже на основании значений R-фактора. Таким образом алгоритм сортирует атомы по «важности» для конкретной экспериментальной PDF; при этом самые важные атомы образуют наиболее вероятную структурную модель исследуемого вещества.</p>
<p>Ученые подтвердили достоверность разработанного подхода на трех различных модельных системах: фуллерене C<sub>60</sub>, аморфном оксиде молибдена MoO<sub>x</sub>, полиоксовольфрамате, содержащем фрагмент W<sub>12</sub>O<sub>40</sub>. Авторы отмечают, что алгоритм не только надежно предсказывает правильные структурные фрагменты для рассмотренных модельных систем, но и работает значительно быстрее простого перебора миллиардов вариантов структур — 100 секунд против 3 миллионов лет.</p>
<p>Одним из очевидных ограничений алгоритма является необходимость наличия искомой структурной модели в исходной крупной структуре, чтобы алгоритм мог ее идентифицировать. В то же время, алгоритм достаточно быстр для совместного использования с <a href="https://pdfitc.org">другими подходами</a> к поиску структурных моделей на основании данных PDF.</p>
</article>

        </main><footer id="footer">
    © 2024 Dimitry Grebenyuk
</footer>
</body>
</html>
